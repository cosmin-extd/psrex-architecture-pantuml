//PSREX Modules
Table PSREX_NODES as M {
  id int [pk, increment] // auto-increment
  name varchar(255)
  description varchar(255)
  full_name varchar
  type node_type
  git_repo_url varchar(255)
}

Enum node_type {
  Database
  RabbitMQ
  dotNET
  JavaEE
  SpringBoot
  Micronaut
  MavenDependency
  ExternalService
}

Table PSREX_EDGES_relations as R {
  id int [pk, increment]
  full_name varchar
  left_node_id int
  right_node_id int
  flow_id int
  connection_type connection_type_enum
  destination_url varchar(255) // endpoint, db table or queue
  endpoint_called_verb varchar(255) // relevant when destination_url is REST endpoint 
  call_description varchar(255)
}

Enum connection_type_enum{
  RESTCall
  SOAPCall
  FTPCall
  QueuePush
  QueuePull
  DatabaseInsert
  DatabaseSelect
  MavenDependency
}

Table PSREX_FLOWS as F {
  id int [pk, increment]
  name varchar(255)
  type flow_type_enum
  description varchar(1255)
}

// Client calls: calls from client modules
// Integrations: calls from outside system
// Jobs: triggered from inside the system from one point
Enum flow_type_enum{
  ClinetCall
  Integration
  Job
}

Table PSREX_CONTAINERS as C {
  id int [pk, increment]
  image_name varchar(255)
  server am_server_enum
  module_node_id int
  fix_version_id int
  description varchar(1255)
}

Enum am_server_enum{
  am1
  am2
  am3
}

Table FIX_VERSIONS as F {
  id int [pk, increment]
  name varchar(255)
  jira_url varchar(255)
  gdrive_url varchar(255)
  start_date varchar(255)
  end_date varchar(255)
  description varchar(255)
  last_commit varchar(255)//where Git tag is placed
}

Table JIRA_STORIES as J {
  id int [pk, increment]
  name varchar(255)
  jira_url varchar(255)
  fix_version_id int
}

Table BUILD_DOT_GRADLES as B {
  id int [pk, increment]
  name varchar(255)
  git_url varchar(255)
  node_id int
}

Table INTERNAL_GRADLE_DEPENDENCIES as G { // developed by our teams
  id int [pk, increment]
  name varchar(255)
  git_url varchar(255)
  nexus_url varchar(255)
  build_dot_gradle_id int
}

Ref: R.left_node_id > PSREX_NODES.id
Ref: R.right_node_id > PSREX_NODES.id  
Ref: R.flow_id > PSREX_FLOWS.id  
Ref: C.module_node_id > PSREX_NODES.id
Ref: B.node_id > PSREX_NODES.id
Ref: C.fix_version_id > FIX_VERSIONS.id
Ref: J.fix_version_id > FIX_VERSIONS.id
Ref: G.build_dot_gradle_id > BUILD_DOT_GRADLES.id
